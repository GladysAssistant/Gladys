
module.exports = function(originalText){

  var percentageToSearch = ['cent', 'un', 'deux', 'trois', 'quatre', 'cinq', 'six', 'sept', 'huit', 'neuf', 'dix', 'onze', 'douze', 'treize', 'quatorze', 'quinze', 'seize', 'Dix sept', 'Dix huit', 'Dix neuf', 'vingt', 'vingt et un', 'vingt deux', 'vingt trois', 'vingt quatre', 'vingt cinq', 'vingt six', 'vingt sept', 'vingt huit', 'vingt neuf', 'trente', 'trente et un', 'trente deux', 'trente trois', 'trente quatre', 'trente cinq', 'trente six', 'trente sept', 'trente huit', 'trente neuf', 'quarante', 'quarante et un', 'quarante deux', 'quarante trois', 'quarante quatre', 'quarante cinq', 'quarante six', 'quarante sept', 'quarante huit', 'quarante neuf', 'cinquante', 'cinquante et un', 'cinquante deux', 'cinquante trois', 'cinquante quatre', 'cinquante cinq', 'cinquante six', 'cinquante sept', 'cinquante huit', 'cinquante neuf', 'soixante', 'soixante et un', 'soixante deux', 'soixante trois', 'soixante quatre', 'soixante cinq', 'soixante six', 'soixante sept', 'soixante huit', 'soixante neuf', 'soixante dix', 'soixante et onze', 'soixante douze', 'soixante treize', 'soixante quatorze', 'soixante quinze', 'soixante seize', 'soixante dix sept', 'soixante dix huit', 'soixante dix neuf', 'quatre vingt', 'quatre vingt un', 'quatre vingt deux', 'quatre vingt trois', 'quatre vingt quatre', 'quatre vingt cinq', 'quatre vingt six', 'quatre vingt sept', 'quatre vingt huit', 'quatre vingt neuf', 'quatre vingt dix', 'quatre vingt onze', 'quatre vingt douze', 'quatre vingt treize', 'quatre vingt quatorze', 'quatre vingt quinze', 'quatre vingt seize', 'quatre vingt dix sept', 'quatre vingt dix huit', 'quatre vingt dix neuf', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'Seventeen', 'Eighteen', 'Nineteen', 'twenty', 'twenty one', 'twenty two', 'twenty three', 'twenty four', 'twenty five', 'twenty six', 'twenty seven', 'twenty eight', 'twenty nine', 'thirty', 'thirty one', 'thirty two', 'thirty three', 'thirty four', 'thirty five', 'thirty six', 'thirty seven', 'thirty eight', 'thirty nine', 'forty', 'forty one', 'forty-two', 'forty-three', 'forty four', 'forty five', 'forty six', 'forty-seven', 'forty-Eight', 'forty-nine', 'fifty', 'fifty-one', 'fifty-two', 'fifty three', 'fifty-four', 'fifty-five', 'fifty six', 'fifty seven', 'fifty eight', 'fifty-nine', 'sixty', 'sixty-one', 'sixty-two', 'sixty three', 'sixty four', 'sixty-five', 'sixty six', 'sixty seven', 'sixty eight', 'sixty nine', 'seventy', 'seventy-one', 'seventy-two', 'seventy three', 'seventy four', 'seventy-five', 'seventy six', 'seventy-seven', 'seventy eight', 'seventy nine', 'eighty', 'eighty one', 'eighty two', 'eighty three', 'eighty four', 'eighty five', 'eighty six', 'eighty seven', 'eighty-eight', 'eighty-nine', 'ninety', 'ninety-one', 'ninety-two', 'ninety-three', 'ninety four', 'ninety five', 'ninety six', 'ninety seven', 'ninety-eight', 'ninety-nine', 'hundred', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '100'];

  var result; //handle only one percentage in a sentence

  var text = originalText;

  // we reverse elements in order to prevent matching quatre vingt in a text containing quatre vingt dix for example
  percentageToSearch.reverse().forEach(function(percentageToSearch){
    ['%', ' pourcent', ' percent', ' %'].forEach(function(percent) {
      if(originalText.toLowerCase().indexOf(percentageToSearch + percent) >= 0 && !result) {
        // we keep only the numerical value
        result = percentageToSearch.replace(percent, '');
        // and we replace this value per %PERCENTAGE%
        text = originalText.replace(percentageToSearch + percent, '%PERCENTAGE%%');
      }
    });
  });

  return {
    text, 
    percentage: toNumber(result),
  };
};

function toNumber(value) {
  var mappingTable = {'cent':100, 'un':1, 'deux':2, 'trois':3, 'quatre':4, 'cinq':5, 'six':6, 'sept':7, 'huit':8, 'neuf':9, 'dix':10, 'onze':11, 'douze':12, 'treize':13, 'quatorze':14, 'quinze':15, 'seize':16, 'Dix sept':17, 'Dix huit':18, 'Dix neuf':19, 'vingt':20, 'vingt et un':21, 'vingt deux':22, 'vingt trois':23, 'vingt quatre':24, 'vingt cinq':25, 'vingt six':26, 'vingt sept':27, 'vingt huit':28, 'vingt neuf':29, 'trente':30, 'trente et un':31, 'trente deux':32, 'trente trois':33, 'trente quatre':34, 'trente cinq':35, 'trente six':36, 'trente sept':37, 'trente huit':38, 'trente neuf':39, 'quarante':40, 'quarante et un':41, 'quarante deux':42, 'quarante trois':43, 'quarante quatre':44, 'quarante cinq':45, 'quarante six':46, 'quarante sept':47, 'quarante huit':48, 'quarante neuf':49, 'cinquante':50, 'cinquante et un':51, 'cinquante deux':52, 'cinquante trois':53, 'cinquante quatre':54, 'cinquante cinq':55, 'cinquante six':56, 'cinquante sept':57, 'cinquante huit':58, 'cinquante neuf':59, 'soixante':60, 'soixante et un':61, 'soixante deux':62, 'soixante trois':63, 'soixante quatre':64, 'soixante cinq':65, 'soixante six':66, 'soixante sept':67, 'soixante huit':68, 'soixante neuf':69, 'soixante dix':70, 'soixante et onze':71, 'soixante douze':72, 'soixante treize':73, 'soixante quatorze':74, 'soixante quinze':75, 'soixante seize':76, 'soixante dix sept':77, 'soixante dix huit':78, 'soixante dix neuf':79, 'quatre vingt':80, 'quatre vingt un':81, 'quatre vingt deux':82, 'quatre vingt trois':83, 'quatre vingt quatre':84, 'quatre vingt cinq':85, 'quatre vingt six':86, 'quatre vingt sept':87, 'quatre vingt huit':88, 'quatre vingt neuf':89, 'quatre vingt dix':90, 'quatre vingt onze':91, 'quatre vingt douze':92, 'quatre vingt treize':93, 'quatre vingt quatorze':94, 'quatre vingt quinze':95, 'quatre vingt seize':96, 'quatre vingt dix sept':97, 'quatre vingt dix huit':98, 'quatre vingt dix neuf':99, 'one':1, 'two':2, 'three':3, 'four':4, 'five':5, 'six':6, 'seven':7, 'eight':8, 'nine':9, 'ten':10, 'eleven':11, 'twelve':12, 'thirteen':13, 'fourteen':14, 'fifteen':15, 'sixteen':16, 'Seventeen':17, 'Eighteen':18, 'Nineteen':19, 'twenty':20, 'twenty one':21, 'twenty two':22, 'twenty three':23, 'twenty four':24, 'twenty five':25, 'twenty six':26, 'twenty seven':27, 'twenty eight':28, 'twenty nine':29, 'thirty':30, 'thirty one':31, 'thirty two':32, 'thirty three':33, 'thirty four':34, 'thirty five':35, 'thirty six':36, 'thirty seven':37, 'thirty eight':38, 'thirty nine':39, 'forty':40, 'forty one':41, 'forty-two':42, 'forty-three':43, 'forty four':44, 'forty five':45, 'forty six':46, 'forty-seven':47, 'forty-Eight':48, 'forty-nine':49, 'fifty':50, 'fifty-one':51, 'fifty-two':52, 'fifty three':53, 'fifty-four':54, 'fifty-five':55, 'fifty six':56, 'fifty seven':57, 'fifty eight':58, 'fifty-nine':59, 'sixty':60, 'sixty-one':61, 'sixty-two':62, 'sixty three':63, 'sixty four':64, 'sixty-five':65, 'sixty six':66, 'sixty seven':67, 'sixty eight':68, 'sixty nine':69, 'seventy':70, 'seventy-one':71, 'seventy-two':72, 'seventy three':73, 'seventy four':74, 'seventy-five':75, 'seventy six':76, 'seventy-seven':77, 'seventy eight':78, 'seventy nine':79, 'eighty':80, 'eighty one':81, 'eighty two':82, 'eighty three':83, 'eighty four':84, 'eighty five':85, 'eighty six':86, 'eighty seven':87, 'eighty-eight':88, 'eighty-nine':89, 'ninety':90, 'ninety-one':91, 'ninety-two':92, 'ninety-three':93, 'ninety four':94, 'ninety five':95, 'ninety six':96, 'ninety seven':97, 'ninety-eight':98, 'ninety-nine':99, 'one hundred':100};

  if(isNaN(value)) {
    value = mappingTable[value];
  } else {
    value = parseFloat(value);
  }
  
  return value;
}
